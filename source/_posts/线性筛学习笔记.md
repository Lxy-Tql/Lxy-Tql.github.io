---
title: 线性筛学习笔记
top: 2
tag: 
- 学习笔记
- 素数
---
看了一大堆令人自闭的证明，还是写写自己~~愚蠢~~的理解吧

```cpp
for(int i=2;i<=n;i++){
    if(v[i]) pr[++top]=i;
    for(int j=1;j<=top&&pr[j]*i<=n;j++){
        v[pr[j]*i]=0;
        if(i%pr[j]==0) break;
    }
}
```
模板代码。线性筛的本质，也就是保证一个数只会被它的**最小质因子$*$最大因数**所筛去。那句$if$ $($i $\%$ $pr[j]==0$ $)$ $break;$
 什么意思呢？

我所理解，就是如果$i$ $\%$ $pr[j]==0$，那么$i$就可以写成$pr[j]*x$。

$x$可能比$pr[j]$要小，那么$pr[j]$就不是所筛的下一个合数的最小质因子，也就是说会被重复筛去。

举个栗子：$i=6$，若$pr[j]=2$时没有$break$，那么$pr[j]=3$时会筛去$18$，然而$18$还会在$i=9$时被$9*2$筛去，就重复筛了。

所以说，这句话很重要$($~~这不是废话吗~~$)$。